---
layout: post
title:  "리뉴얼 계획안 header 2017/12/17"
icon:  heart-o
category: [programing]

---



monggoDB Draft

서론 

https://docs.mongodb.com/manual/tutorial/getting-started/
https://docs.mongodb.com/manual/core/document/



 각종 db종류들  
https://pjt3591oo.github.io/blog/database/2017/04/06/about-database.html —> db 종류 정말 기초 적인 내용중에 기초 그런데 스키마와 같은 디비 객체에 대한 언급이 없음



%이글은 일부로 글로만 작성합니다. 사용 실례보다는 정리하는 이점이라서요%



왜 noSQL을 설명 하고자 하는 데 이런것들을 보라는 지는 몰랐을꺼야~~~~~

하지만 나름 db를 배웠던 만큼 nosql은 신기 하면서 쉽게 접할 수 있으나 

왜  rdbms가 있는데 왜 굳이 noSQL을 사용하는지 또한 지금 현재 필자의 상황에서 

잘 접하기 힘든 주제이기에?! 이러한 설명들을 덧붙여서 배경지식에 포함 했으면 하는 바램으로 이렇게 시작하는 

초고 이며 서론이기에 

굉장히 주관!!!! 적인 의견이 많은 글일 수 있어서 나름 정리하면서 보았던 url들의 언급을 해두었다.

먼가 의미가 주관적이야!!! 그럼 바로 참고 하셔 주기를.... 바랍니다.

주의!!! 이글은 나를 이해시키기 위한 관점에서의 글 이기도 합니다.

이글을 읽고 바로!! 아하!!! 유레카!!! 지를수 없으며, 필자의 경우 어느정도의 배경지식이 

있기에 이러한 느낌으로?! 작성한 글입니다.   



스키마란 무엇인가?? - DB구조를 정의하기 위해 사용하는 개념?!!!

데이터 시스템 언어 회의(CODASYL)에서 데이터베이스를 기술하기 위해 사용하기 시작한 개념. 

데이터베이스의 구조에 관해서 이용자가 보았을 때의 논리 구조와 컴퓨터가 보았을 때의 물리 구조에 대해 기술하고 있다. 

데이터 전체의 구조를 정의하는 개념 스키마, 실제로 이용자가 취급하는 데이터 구조를 정의하는 외부 스키마 및 데이터 구조의 형식을 구체적으로 정의하는 내부 스키마가 있다.

스키마라고 하는 것은 현실세계의 자료들을 DB로 옮기기 위하여 모델링을 하게 되는 데 그 결과 생성된 구조물들을 얘기합니다. 

주로 디비/테이블 구조/그리고 각각의 테이블 및 속성들간의 관계 등등을 얘기합니다.

데이터 베이스를 구성하는 자료 객체(Entity), 이들의 속성(Attribute), 이들 간에 존재하는 관계(Relation) 그리고 자료의 조작과 이들 자료값들이 갖는 제약 조건에 관한 정의를 총칭하는 것
조직 전체의 입장에서 본 데이터베이스 구조로써 데이터베이스 내의 개체와 개체들의 관계 그리고 제약조건 등에 대한 명세를 말한다. 단순하게 데이터베이스 구조를 나타내는 모든 것들 이라고 생각하면 될 듯
스키마란것은 오브젝트(테이블, 인덱스, 뷰 등을 오브젝트라고 합니다.)의 성(이름앞에 붙는 성)이라고 생각하시면 됩니다.
누가 만들었는지 또는 어떤 성질을 가진것인지를 나타내 주는 것입니다.


요약(주관적 관점에서)

http://jepi.tistory.com/132 <— 참고 잘 정리 된듯

어떤 특정 용도를 위한 데이터의 조직화된 집합을 데이터 베이스의 주요 개념으로 보면된다.

이러한 용도를 구현하는 일은 
추상화를 이야기하는 느낌이다. 

(이를 실행시 instance화 되어서 객채화가 된다. 참고 문구 먼가 적어 놔야 기억함) 예를 들어 내가 클래스를 통해서 데이터를 정의 한다고 생각해 보자. 
그럴때 사용되는 제약적인 것들이나 관계들에 대한 내가 정의한 것들의 명세서라고 생각하자 
그래서 내가 정의한 것들이 의미를 나타내는 것이다 .
db를 공부하다 보면 항상 느끼는 것은 테이블 인덱스 뷰 등의 객체들을
부를때나 정의를 할때를 생각해 보면 ->(필자는 대로 스키마를 작성하고 한적은 없다. 나중에 공부가 필요 할 것 같다.)

테이블은 db에서의 가장 기본적인 객체라고 봄.

테이블_해당 스키마 —> 해당스키마의 테이블

즉, 해당 스키마라는 명세서에서 기초화된 데이터 테이블이라는 것이다.

mogodb에서 소개하는  nodal vs rdbms

내 주관적으로 공부한 rdbms

rdbms 는 스키마로 하여금
테이블간의 key값을 이용하며,
각 데이터들의  entity, attribute, data-type을 
정의하고 중복되는 데이터들을 제거(효율적인 저장을 위해)해나가며
 하나의 추상적인 개념을 구현한다.(oop에서의 추상화 같은 거 같음) 

ex) 쇼핑 —> 가장 많이 보이는 주제 (구글링함녀 많이 나와요!!
주의 사항은 논리 모델과 물리 모델이 나누어져서 있음 그러니 항상 문구를 참고하고 이러한것들 있네?! 하면서 참고를 해야 합니다. 


!!!!!기타 
참고 사항; tool—> exerd검색!! —>요게 db 모델링을 할때 사용하면 시각적으로 
표현하고 지정할 수 있어요!!! 기존 디비 모델링 사진들 있쥬?! 그런 느낌으로 쭈아~~악 
볼수 있어요 
다양한 모델링 tool들이 있으니 그런거 함 참고해서 봐주세요!!! 

참고로 exerd는 1달 무료)


db의 모델링을 한다고 해보자. 
대략적으로 예전에 경험했을 때의 과정들이다 . 

1.용도는 무엇!? 

2.테이블 및 엔터티 작성 (마크업의 아웃라인 같음)

3.정규화를 통한 (효율적인 관리를 위한 1~3차 정도의 작업 더 할 수 도 있음.

4.가짜 데이터들 및 구성후 테스트 

5.알아서 하세요!(요건 증말 어떻게 될지 몰라서 그런거에요 위의 과정을 반복할수도)


(참고: keyword db 모델링 정규화, 비정규화

데이터 용량의 효율적인 사용과 데이터들의 효율적인 관리를 위한 과정들이에요)



db를 이루는 객체들은 머가 있을까요!?
아래 url 참고
https://blog.naver.com/chsmanager/140210272936 <— 기본 디비 객체 들에 대한 설명 짧아서 좋음 


정리:
테이블의 시각화(<—>view: 실제로는 데이터가 없는 가상의 논리 테이블로서 여러개의 조인을 통해서 쓰는 경우 매번 쿼리를 작성하는 것이 아니라 가상의 view라는 논리 테이블을 작성하고 이 view를 통해서 가져온다. 다만 이러한 경우 속도의 문제가 있을 수 있다. join의 자동화라고 보면 된다.)와 논리 모델, 물리 모델 

논리 모델  : 내가 구현하는 것들에 대해 테이블 칼럼에 대하여 의미를 부여 한다 추상화를 통한 용도에 맞는 구체화 . 테이블, 테이블 끼리의 관계나 칼럼의 엔터티, key 값을 정의한다. 

물리 모델  : 실질적인 데이터 타입을 지정한다(그러면 자동적으로 데이터 타입들이 정의 되겠쥬?!)

왜?! rdbms를 사용하냐고요!?

이러한 과정을 통하여 구성되는 rdbms는 내가 사용하고자 하는 용도에 대해서 specific하고 정의한 data-type데로 일정하게 데이터를 추가하고, 읽고 삭제 변경 (c r u d)를 할 수 있으며, 유지보수에 용이합니다. 


BUT

1.수많은 데이터들이나 특정 data 형식이 갖춰지지 않는 상황에서의 효율은 낮습니다. )_빅데이터 같은 경우 

2.null값이라던가 <— 요놈은 db들 마다 다를 수 있음 어떤건 허용 어떤거는 허용치 않음

3.view객체의 경우 많은 테이블들을 미리 불러 오거나 하는 경우도 있지만 그만큼  느릴 수 있음. rdbms는 기본적으로 join을 통해서 여러테이블을  읽고 쓰고 변경하고 삭제하고 할수 있어요. 이렇든 매번 여러테이블을 join해오는 번거로움을 가상의 객체를 통해 미리 지정해두고 참고해 오는 방식이 view객체에요.
하지만 이러한 방식은 규모에 따라서?! 시간이 오래 걸리고, 비효율적일 수 있어요. 

4.rdbms는 스키마를 정의하고 스키마를 토대로하여  데이터의 관계나 형식을 고려(이름의 경우 String만 받는 다거나 email형식이어야 한다든가 예시임)하여 관리를 하는 측면에서는 굉장히 효율적이며 공정하고 구조화 되어있어요.

예를 들어서 
트랜젝션의 경우가 그렇습니다. (<— 조건 안맞으면 보안?! 및 안정성을 위하여 되돌리거나 혹은 허가가 있어야 수행해야하는  경우에 대해서. ex) 은행 디비 참고(은행이라는 특수한 상황에서); keyword : 트랜잭션 <—요고요고 재미짐
구글 센세께 여쭤보세염 
)

5.시나리오에 따른 데이터의 관리 (시나리오 즉 스키마에 안맞거나(테이블 관계또한), 타입이 안맞으면 crud 처리가 불가 할 수 있음)4번과 같은 요점이나 rdbms는 nosql보다는 구조적이어서 용도에 맞게 내가 모델링을 하였으나 그 만큼을 못할 수 있어요.
전체적으로 시나리오나 왜 이러하게 짰는지 공유가 안되면 팀원과의 의견이 다를 수 있기 때문에 갠적으로 느낀 점이나 공유에 직관적이지 않는거 같아서 적어봐요. 물론noSQL또한 시나리오가 있어야 collection(뒤에서 설명) 작성이 용이하나 좀더 직관적이고, 개발 시작하는 사람이 쉽게 접할수 있는 구조이다.) 

6.rdbms의 경우 하나의 전체 데이터 베이스를 단일 서버하나가 호스팅함.  확장시 무지막지하게 돈이듬(keyword: scaleup)
(<—> 참고; AWS같은 클라우딩 서비스 비용절감 측명에서 이용가능

폐쇄형 서비스의 경우가 많음 개발에서는 무료지만 막상 상업적으로는 아닐 수 있음, nosql은 오픈소스
그래서 소프트웨어 투자 비용 적음 

참고; 좋은거 sql injection http://blog.plura.io/?p=6056
http://taeyo.net/columns/View.aspx?SEQ=86&PSEQ=8&IDX=1

)

요약
RDBMS는
수많은 데이터들(빅데이터를 예시)을 저장하기에는 (비정형적인 데이터를 처리하는데 있어서는) 데이터들의 제약 조건 같은 컨디션에 의해서 굉장히 비효율 적일 수 있다.





이러한 장단점들에 의해서 선택할 수 있는 db의 종류는 
noSQl db 입니다.

일단 스키마의 정의가 필요하지 않습니다. 
sql이라 함음 
rdbms에서 데이터들 테이블을 관리하기 위해서 사용하는 특수한 프로그래밍 언어입니다.
(참고, 과거 sql들은 mysql과 oracle의 경우는 다른 sql 코드가 있음-->통합추세이나,
mysql과 oracle은 다른 것들이 포함되어 있어요. 그래서 통합 쿼리라는 것들을 작성하기도 하며 이와 더블어 객체(자바의 경우 쿼리시 객체를 디비에 날릴때 쿼리에 세팅하여 날림)와 테이블의 이질성(둘은 각각의 환경에서는 객체이나 엄연히 다르다 )을 극복하고자
가상의 이둘의 관계를 해소하고자 생김 프레임 워크가 ORM 프레임 워크가 있어요.

Back to basics(기본에 충실하자) <— orm에 대한 생각 키워드 거의 슬로건

 ==>  dbms에 대한 종속성을 피 할 수 있고, 객체지향 언어와 의 사용에서 비지니스 로직에서 sql쿼리가 분리되므로 유지 보수가 용의 합니다.  

ex) mybatis,ibatis 그러나 mybatis 사용해본 결과 mysql과 oracle에 대해서 다른 경우가 있음...sql은 db에따라 사용해야 하는듯 역시 아직 많은걸 사용해 보지 않았음.

막쓰고 나니 요론걸 찾음 ㅜㅜ 위에꺼는 면접용으로 외워둔거라고 보면 됨.
http://www.incodom.kr/ORM

keyword: ORM(object-relational mapping)
 )



noSQl은 
NoSQL 데이터베이스는 전통적인 관계형 데이터베이스 보다 덜 제한적인 일관성 모델을 이용하는 데이터의 저장 및 검색을 위한 매커니즘을 제공한다. 이러한 접근에 대한 동기에는 디자인의 단순화, 수평적 확장성, 세세한 통제를 포함한다. NoSQL 데이터베이스는 단순 검색 및 추가 작업을 위한 매우 최적화된 키 값 저장 공간으로, 레이턴시와 스루풋과 관련하여 상당한 성능 이익을 내는 것이 목적이다. NoSQL 데이터베이스는 빅데이터와 실시간 웹애플리케이션의 상업적 이용에 널리 쓰인다. 또, NoSQL 시스템은 SQL 계열 쿼리 언어를 사용할 수 있다는 사실을 강조한다는 면에서 "Not only SQL"로 불리기도 한다.

시작에 앞서서 몸풀기 참고해야 할 것 noSQL db에 대한 종류들 
https://subokim.wordpress.com/2011/05/31/nosql-db-four-type/


스키마라는 대신 collection(요게 애매한게 먼가 디비별로 불리어지는 게 다른지 좀 그럼 )이라는 객체 데이터의 정형화와 관계가 없고, 수평적이다. 그로 인해서 안정성(복제), 분산 처리 (sharding)이 용이하다.
key 값이라는 index 또한 불리어지는 이름이 상당히 많다.

즉 대량으로 여러가지 데이터들이 마구마구 쏟아져올때 혹은 소프트웨어 투자 비용을 절감 한다던가 빠르게 사용하고자 할때 굉장한 이점이 있다.

mongodb의 경우는 

document저장을 위해서 

스키마 대신 collection 객체를 사용하며 JSON, xml,yaml, bson(BSON is a binary serialization format used to store documents and make remote procedure calls in MongoDB. )

이라는 형식을 이용해서 저장한다.

이는 rdbms에 비해서 좀더 직관적으로 저장할 수 있으며 json타입 형식이라는 이야기를 보면 알 수 있는 것은 데이터들의 계층구조나 관계를 좀더 직관적인 측면에서 볼 수 있습니다.

noSQL에서의 sql같은 메서드들이 존재 하는데요?! 이러한 쿼리들의 사용은 개인적으로 처음에 보기에는 쉽다고 볼 수 있지만, 먼가 길이가 작고 간단한 만큼 막상 사용하기에는 숙달이 필요 할 거 같습니다.

(data 구조가 key value로 구성이 됩니다.)

noSQL 장점
1.rdbms에 비해서 빠른 처리가 가능(crud).

2.가변적인 구조와,유연적인 저장,
다양한 데이터 타입의 데이타들을 저장할 수 있다. format이 달라도 마구 마구 집어 넣을 수 있어요.

3.관계나 데이터 타입의 제한이 없어서 rdbms에 비해 단순 처리 가능.

4.data안정성이 크다.(복제가 용이해요!)

5.scaleup시 비용이 적어요


단점:
1.너무 가변적인 data들이므로 데이터들의 일관성이 없다.

2.sharding 방식을 사용해서 큰 테이블을 여러 서버에 나누어 저장한다. 또 fault tolerancy를 위해서 데이터는 두 개 이상의 서버에 저장된다. 어떤 데이터의 값에 update가 발생한 경우, NoSQL는 중복 저장된 모든 서버들에 해당 업데이트가 다 될 때까지는 조금 시간이 걸린다.(서버가 아주 많을 수 있다는 점을 생각하자.)
RDBMS에서는 최대 서버수가 기껏 3~5대이기 때문에 모든 서버를 업데이트되기 전까지는 해당 데이터 또는 table에 lock을 걸어서 읽기를 금지한다. 따라서 데이터를 읽어갈 때는 어떤 서버에서 읽더라도 항상 같은 값이 보장된다. 하지만 NoSQL에서는 lock을 하게될 경우 전체 속도가 너무 느려지게 되므로 RDBMS와 같은 lock을 하지 않는다. 따라서 NoSQL의 일부 서버에서는 아주 잠시 동안은 old data가 제공될 수 있다. 물론 시간이 좀 지나면 모든 서버는 결국 같은 값을 가지게 된다. (= Eventual consistency)(<----요건 아직 케이스가 딱히 생각이 안되서 잘 모르겠다

다만 요약하자면 noSQL은 시스템 고장으로 인해서 백업데이터를 두지만, 그로인해서 시스템 장애를 피할 수 있지만, 중복저장된 모든 서버에 업데이트시 수많은 nosql서버의 데이타들때문에 오래 걸릴 수 있어요. 그리고 lock(데이타의 안정성?!을 위해서 update시 모든 서버가 update되어야만 읽기가 가능하도록 하기 위해 사용)을 걸어서 사용시 느릴 수 있어요. 그래서 update시 다른 서버에서는 옛날 데이터를 볼 수 있어요라고 번역함, 참고로 한글 블로그임, 말 개어렵게 썼어욤 여기;http://lazybrain.ikspres.com/nosql1/ )

참고;:샤딩(Sharding)은 샤드 키(Shard key)를 기준으로 하나의 테이블을 수평 분할하여 서로 다른 클러스터에 분산 저장하고 질의할 수 있는 기법이다. 이를 통해 관계형 데이터베이스에서도 부하를 분산할 수 있지만 어플리케이션 레벨에서 모든 샤딩을 제어해야 한다. (어떤 데이터를 어느 클러스터에서 처리해야 하는지 등) 또한 여러 샤드에 걸치는 쿼리나 참조 정합성, 트랜잭션, 일관성의 제어에 문제가 발생한다.

분산 저장을 지원하는 NoSQL 데이터베이스의 경우, 집합-지향(Aggregate-oriented) 모델을 사용하여 이러한 문제를 해결한다. 연관된 데이터들이 함께 분산되므로, 관계형 모델에서처럼 복잡한 제어가 필요하지 않게 된다.




끝내며

요점: nosql은 다양한 데이터 타입과 대량의 데이터를 저장하고 사용하는데 있어서 관계형 디비보다 효율적이다!!


위를 정리한 이유는 일단 db 사용에 있어서 기초 자료?! 정도로 될 수 있을 듯해서 

올려 보며

이는 굉장히 주관 적이므로 구글링을 추천 드림.

사진을 안올리는 이유는 

구글링!!!! 


모임때는 나름 사진 넣어서 해볼게요 

보기 불편하시면 ㅜㅜㅜ 죄송합니당!!! (_ _)







 